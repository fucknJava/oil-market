import{c as I,g as D,r as m,b as h,j as e,C as F,L as p,R as H,U as O,P as W,M as V,S as Z,h as _,T as B,i as G,k as $,o as J}from"./index-ButzSU1d.js";import{C as K}from"./check-circle-qc9K5inJ.js";import{A as Q}from"./alert-circle-BNpoCPrq.js";import{L as X}from"./lock-CktMV0MW.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=I("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=I("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);function le(){var w,M,C,A,S;D();const[r,o]=m.useState(1),[j,u]=m.useState(!1),[x,P]=m.useState(null),[b,l]=m.useState(""),N=h(s=>s.items),R=h(s=>s.getTotal()),E=h(s=>s.clear),[a,v]=m.useState({contactName:"",phone:"",email:"",deliveryMethod:"pickup",deliveryAddress:{city:"",street:"",house:"",apartment:"",comment:""},paymentMethod:"card",notes:""}),c=[{id:"pickup",label:"Самовывоз",price:0,icon:e.jsx(_,{})},{id:"courier",label:"Курьером по городу",price:300,icon:e.jsx(B,{})},{id:"russia",label:"По России",price:500,icon:e.jsx(G,{})}],y=[{id:"card",label:"Банковская карта",icon:e.jsx($,{})},{id:"cash",label:"Наличные при получении",icon:e.jsx(Y,{})},{id:"upon_receipt",label:"Картой при получении",icon:e.jsx($,{})}],d=(s,t)=>{v(i=>({...i,[s]:t}))},n=(s,t)=>{v(i=>({...i,deliveryAddress:{...i.deliveryAddress,[s]:t}}))},g=()=>a.contactName.trim()?a.phone.trim()?/^[\+]?[0-9]{10,15}$/.test(a.phone.replace(/[\s\-\(\)]/g,""))?!0:(l("Введите корректный номер телефона"),!1):(l("Введите телефон"),!1):(l("Введите имя"),!1),f=()=>{if(a.deliveryMethod!=="pickup"){if(!a.deliveryAddress.city.trim())return l("Введите город"),!1;if(!a.deliveryAddress.street.trim())return l("Введите улицу"),!1;if(!a.deliveryAddress.house.trim())return l("Введите номер дома"),!1}return!0},U=()=>{l(""),!(r===1&&!g())&&(r===2&&!f()||o(s=>Math.min(s+1,4)))},k=()=>{l(""),o(s=>Math.max(s-1,1))},T=async()=>{if(!(!g()||!f())){u(!0),l("");try{const s=N.map(L=>({productId:L.productId,quantity:L.quantity})),t={...a,items:s},i=await J.create(t);i.success?(P(i.order),E(),o(4)):l(i.error||"Ошибка при создании заказа")}catch(s){l(s.message||"Ошибка при создании заказа")}finally{u(!1)}}},z=R+(((w=c.find(s=>s.id===a.deliveryMethod))==null?void 0:w.price)||0);return x?e.jsx("div",{className:"min-h-screen py-20",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(K,{className:"w-10 h-10 text-green-400"})}),e.jsx("h1",{className:"text-3xl md:text-4xl font-heading font-bold mb-4",children:"Заказ успешно оформлен!"}),e.jsxs("div",{className:"card p-8 mb-6 text-left",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Номер заказа:"}),e.jsx("span",{className:"text-xl font-bold gradient-text",children:x.orderNumber})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Трек-номер:"}),e.jsx("span",{className:"text-lg font-mono font-bold text-primary-400",children:x.trackingNumber})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Сумма:"}),e.jsxs("span",{className:"text-xl font-bold",children:[x.totalAmount.toLocaleString("ru-RU")," ₽"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Статус:"}),e.jsx("span",{className:"badge-success",children:"Обрабатывается"})]})]}),e.jsx("div",{className:"mt-8 p-4 bg-dark-800/50 border border-dark-700 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(F,{className:"w-5 h-5 text-primary-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-1",children:"Что дальше?"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Мы свяжемся с вами для подтверждения заказа в течение 2 часов. Отслеживать статус заказа можно по трек-номеру выше."})]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(p,{to:"/profile/orders",className:"btn-primary px-8 py-3",children:"Мои заказы"}),e.jsx(p,{to:"/catalog",className:"btn-outline px-8 py-3",children:"Продолжить покупки"})]}),e.jsxs("div",{className:"mt-8 text-sm text-gray-400",children:["Если у вас есть вопросы, звоните:",e.jsx("a",{href:"tel:+79502865525",className:"text-primary-400 ml-1",children:"+7 950 286 55 25"})]})]})})}):e.jsx("div",{className:"min-h-screen py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("div",{className:"mb-12",children:e.jsx("div",{className:"flex items-center justify-center",children:[{number:1,label:"Контактные данные"},{number:2,label:"Доставка"},{number:3,label:"Оплата"},{number:4,label:"Подтверждение"}].map((s,t)=>e.jsxs(H.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`
                    w-10 h-10 rounded-full flex items-center justify-center
                    ${r>=s.number?"bg-primary-500 text-white":"bg-dark-800 text-gray-400"}
                    ${r===s.number?"ring-4 ring-primary-500/30":""}
                    transition-all duration-300
                  `,children:s.number}),e.jsx("div",{className:`
                    mt-2 text-sm hidden md:block
                    ${r>=s.number?"text-primary-400":"text-gray-500"}
                  `,children:s.label})]}),t<3&&e.jsx("div",{className:`
                    w-24 h-1 mx-4
                    ${r>s.number?"bg-primary-500":"bg-dark-800"}
                    transition-all duration-300
                  `})]},s.number))})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"card p-6 mb-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:k,disabled:r===1,className:"flex items-center gap-2 text-gray-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(q,{className:"w-4 h-4"}),"Назад"]})}),b&&e.jsx("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx(Q,{className:"w-5 h-5"}),b]})}),r===1&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Контактные данные"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"ФИО *"]})}),e.jsx("input",{type:"text",value:a.contactName,onChange:s=>d("contactName",s.target.value),className:"input",placeholder:"Иванов Иван Иванович",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Телефон *"]})}),e.jsx("input",{type:"tel",value:a.phone,onChange:s=>d("phone",s.target.value),className:"input",placeholder:"+7 (999) 999-99-99",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),"Email"]})}),e.jsx("input",{type:"email",value:a.email,onChange:s=>d("email",s.target.value),className:"input",placeholder:"email@example.com"})]})]})]})]}),r===2&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Способ доставки"}),e.jsx("div",{className:"space-y-4 mb-8",children:c.map(s=>e.jsxs("label",{className:`
                          flex items-center justify-between p-4 border rounded-xl cursor-pointer
                          transition-all duration-300
                          ${a.deliveryMethod===s.id?"border-primary-500 bg-primary-500/5":"border-dark-700 hover:border-dark-600"}
                        `,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.deliveryMethod===s.id?"bg-primary-500 text-white":"bg-dark-800 text-gray-400"}`,children:s.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.label}),e.jsxs("div",{className:"text-sm text-gray-400",children:[s.id==="pickup"&&"ул. Дзержинского, 4, стр. 7, Большой Камень",s.id==="courier"&&"Доставка курьером по городу",s.id==="russia"&&"Доставка по всей России"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold",children:s.price===0?"Бесплатно":`${s.price} ₽`}),e.jsxs("div",{className:"text-sm text-gray-400",children:[s.id==="pickup"&&"1-2 дня",s.id==="courier"&&"1-2 дня",s.id==="russia"&&"2-7 дней"]})]}),e.jsx("input",{type:"radio",name:"deliveryMethod",value:s.id,checked:a.deliveryMethod===s.id,onChange:t=>d("deliveryMethod",t.target.value),className:"hidden"})]},s.id))}),a.deliveryMethod!=="pickup"&&e.jsxs("div",{className:"border-t border-dark-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Адрес доставки"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Город *"}),e.jsx("input",{type:"text",value:a.deliveryAddress.city,onChange:s=>n("city",s.target.value),className:"input",placeholder:"Москва",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Улица *"}),e.jsx("input",{type:"text",value:a.deliveryAddress.street,onChange:s=>n("street",s.target.value),className:"input",placeholder:"Ленина",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Дом *"}),e.jsx("input",{type:"text",value:a.deliveryAddress.house,onChange:s=>n("house",s.target.value),className:"input",placeholder:"15",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Квартира/офис"}),e.jsx("input",{type:"text",value:a.deliveryAddress.apartment,onChange:s=>n("apartment",s.target.value),className:"input",placeholder:"25"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Комментарий для курьера"}),e.jsx("textarea",{value:a.deliveryAddress.comment,onChange:s=>n("comment",s.target.value),className:"input min-h-[100px] resize-none",placeholder:"Дополнительные указания"})]})]})]}),r===3&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Способ оплаты"}),e.jsx("div",{className:"space-y-4 mb-8",children:y.map(s=>e.jsxs("label",{className:`
                          flex items-center gap-4 p-4 border rounded-xl cursor-pointer
                          transition-all duration-300
                          ${a.paymentMethod===s.id?"border-primary-500 bg-primary-500/5":"border-dark-700 hover:border-dark-600"}
                        `,children:[e.jsx("div",{className:`p-2 rounded-lg ${a.paymentMethod===s.id?"bg-primary-500 text-white":"bg-dark-800 text-gray-400"}`,children:s.icon}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"font-medium",children:s.label})}),e.jsx("input",{type:"radio",name:"paymentMethod",value:s.id,checked:a.paymentMethod===s.id,onChange:t=>d("paymentMethod",t.target.value),className:"hidden"})]},s.id))}),e.jsxs("div",{className:"border-t border-dark-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Примечание к заказу"}),e.jsx("textarea",{value:a.notes,onChange:s=>d("notes",s.target.value),className:"input min-h-[100px] resize-none",placeholder:"Дополнительные пожелания или комментарии к заказу..."})]})]}),r===4&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Подтверждение заказа"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-dark-800/50 border border-dark-700 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Контактные данные"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"ФИО:"}),e.jsx("span",{children:a.contactName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Телефон:"}),e.jsx("span",{children:a.phone})]}),a.email&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Email:"}),e.jsx("span",{children:a.email})]})]})]}),e.jsxs("div",{className:"p-4 bg-dark-800/50 border border-dark-700 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Доставка"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Способ:"}),e.jsx("span",{children:(M=c.find(s=>s.id===a.deliveryMethod))==null?void 0:M.label})]}),a.deliveryMethod!=="pickup"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Адрес:"}),e.jsxs("span",{className:"text-right",children:[a.deliveryAddress.city,", ",a.deliveryAddress.street,", ",a.deliveryAddress.house,a.deliveryAddress.apartment&&`, кв. ${a.deliveryAddress.apartment}`]})]}),a.deliveryAddress.comment&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Комментарий:"}),e.jsx("span",{children:a.deliveryAddress.comment})]})]})]})]}),e.jsxs("div",{className:"p-4 bg-dark-800/50 border border-dark-700 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Оплата"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Способ:"}),e.jsx("span",{children:(C=y.find(s=>s.id===a.paymentMethod))==null?void 0:C.label})]}),a.notes&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Примечание:"}),e.jsx("span",{children:a.notes})]})]})]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-dark-700 flex justify-between",children:[r>1?e.jsx("button",{onClick:k,className:"btn-outline px-8",children:"Назад"}):e.jsxs(p,{to:"/cart",className:"btn-outline px-8 flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),"В корзину"]}),r<4?e.jsx("button",{onClick:U,className:"btn-primary px-8",children:"Продолжить"}):e.jsx("button",{onClick:T,disabled:j,className:"btn-primary px-8",children:j?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Оформление..."]}):"Подтвердить заказ"})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24",children:[e.jsxs("div",{className:"card p-6 mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-6",children:"Ваш заказ"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 mb-2",children:"Товары:"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto custom-scrollbar pr-2",children:N.map(s=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("div",{className:"flex-1 truncate",children:[s.name," × ",s.quantity]}),e.jsxs("div",{className:"flex-shrink-0",children:[(s.price*s.quantity).toLocaleString("ru-RU")," ₽"]})]},s.productId))})]}),e.jsx("div",{className:"pt-4 border-t border-dark-700",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Доставка:"}),e.jsx("span",{children:((A=c.find(s=>s.id===a.deliveryMethod))==null?void 0:A.price)===0?"Бесплатно":`${(S=c.find(s=>s.id===a.deliveryMethod))==null?void 0:S.price} ₽`})]})}),e.jsx("div",{className:"pt-4 border-t border-dark-700",children:e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Итого:"}),e.jsxs("span",{className:"gradient-text",children:[z.toLocaleString("ru-RU")," ₽"]})]})})]}),e.jsxs("div",{className:"p-4 bg-dark-800/30 border border-dark-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"Безопасная оплата"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(X,{className:"w-3 h-3"}),"Все данные защищены SSL-шифрованием"]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Нужна помощь?"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"По вопросам оформления заказа:"}),e.jsx("a",{href:"tel:+79502865525",className:"block text-lg font-medium hover:text-primary-400 transition-colors",children:"+7 950 286 55 25"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Пн-Пт: 9:00–18:00"})]})]})]})})]})]})})}export{le as default};
